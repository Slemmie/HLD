test:
n < 10^2
0.004 0.003 0.004 0.004 0.005 0.002 0.005 0.002 0.002 0.004
n < 10^3
0.008 0.008 0.008 0.008 0.008 0.010 0.009 0.008 0.008 0.008
n < 10^4
0.047 0.047 0.046 0.042 0.049 0.044 0.047 0.047 0.041 0.046
n < 10^5
0.252 0.232 0.225 0.184 0.186 0.224 0.210 0.215 0.221 0.265
n < 10^6
3.001 2.970 3.026 3.074 3.078 3.063 2.892 2.922 2.971 2.842

naive:
n < 10^2
0.005 0.005 0.006 0.005 0.006 0.006 0.008 0.004 0.004 0.005
n < 10^3
0.026 0.023 0.028 0.024 0.023 0.027 0.032 0.025 0.040 0.027
n < 10^4
1.248 1.137 1.370 1.176 1.319 1.169 1.204 1.202 1.143 1.283
n < 10^5
>8.000 >8.000 >8.000 >8.000 >8.000 >8.000 >8.000 >8.000 >8.000 >8.000
n < 10^6
>8.000 >8.000 >8.000 >8.000 >8.000 >8.000 >8.000 >8.000 >8.000 >8.000
